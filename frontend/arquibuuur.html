<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">

    <title>Arquibuuur - Belenbuuur Fotografia</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="arquibuuur-page">
    <!-- Hero + navegación principal -->
    <section class="hero" id="hero">
        <nav class="navbar">
            <div class="container">
                <ul>
                    <li><a href="index.html">Inicio</a></li>
                    <li><a href="galeria.html">Galeria</a></li>
                    <li><a href="blog.html">Blog</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </div>
        </nav>
        <img src="media/logos/Arquibuuur.png" alt="Fondo Hero Arquibuuur" class="hero-bg">
    </section>

    <main>
        <!-- Listado de álbumes -->
        <section class="albumes" id="albumes">
            <div class="container">
                <div class="albumes-header">
                    <h1>Arquibuuur</h1>
                    <p>Selecciona un album para ver todas sus fotos.</p>
                </div>
                <div id="album-list" class="album-grid" aria-live="polite"></div>
            </div>
        </section>

        <!-- Visor del álbum seleccionado -->
        <section class="album-view" id="album-view">
            <div class="container">
                <div class="album-view-header">
                    <div>
                        <h2 id="album-title">Elige un album</h2>
                        <p id="album-meta">Selecciona un album para cargar las fotos.</p>
                    </div>
                </div>
                <div id="photo-grid" class="photo-grid" aria-live="polite"></div>
            </div>
        </section>
    </main>

    <!-- Lightbox para ver fotos en grande -->
    <div id="lightbox" class="lightbox" aria-hidden="true">
        <button class="lightbox-close" type="button" aria-label="Cerrar">×</button>
        <button class="lightbox-prev" type="button" aria-label="Anterior">‹</button>
        <img id="lightbox-image" alt="">
        <button class="lightbox-next" type="button" aria-label="Siguiente">›</button>
        <div id="lightbox-caption" class="lightbox-caption"></div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script>
        // Datos base de álbumes y fotos
        const rawAlbums = [
            {
                folder: "2020-07-24-Arquibuuur-IVAM-Valencia-24-de-julio-de-2020",
                title: "IVAM Valencia 24 de julio de 2020",
                files: ["_MG_4188.jpg", "_MG_4199.jpg", "_MG_4211.jpg", "_MG_4214.jpg"]
            },
            {
                folder: "2020-07-14-Arquibuuur-Belenpuuur-Valencia-14-de-julio-de-2020",
                title: "Belenpuuur Valencia 14 de julio de 2020",
                files: ["_MG_4093.jpg", "_MG_4097-2.jpg", "_MG_4099.jpg", "_MG_4102.jpg", "_MG_4118.jpg", "_MG_4120.jpg"]
            },
            {
                folder: "2020-01-26-Arquibuuur-Museo-Bombas-Gens-Valencia-26-de-enero-de-2020",
                title: "Museo Bombas Gens Valencia 26 de enero de 2020",
                files: ["_MG_2872.jpg", "_MG_2873.jpg", "_MG_2876.jpg", "_MG_2878.jpg"]
            },
            {
                folder: "2019-10-25-Viajes-Arquibuuur-Benidorm-y-Alicante-25-y-26-de-abril-de-2019",
                title: "Benidorm y Alicante 25 y 26 de abril de 2019",
                files: ["IMG_1722.jpg", "IMG_1745.jpg", "IMG_1753.jpg", "IMG_1758.jpg", "IMG_1762.jpg", "IMG_1770.jpg", "IMG_1774.jpg", "IMG_1780.jpg", "IMG_1794.jpg", "IMG_1797.jpg", "IMG_1799.jpg", "IMG_1804.jpg", "IMG_1810.jpg", "IMG_1815.jpg", "IMG_1819.jpg", "IMG_1821.jpg", "IMG_1828.jpg", "IMG_1831.jpg", "IMG_1833.jpg", "IMG_1834.jpg", "IMG_1836.jpg", "IMG_1837.jpg"]
            },
            {
                folder: "2019-10-18-Viajes-Arquibuuur-Florencia-18-a-21-de-octubre-de-2019",
                title: " Florencia 18 a 21 de octubre de 2019",
                files: ["IMG_0981.jpg", "IMG_1005.jpg", "IMG_1008.jpg", "IMG_1013.jpg", "IMG_1014.jpg", "IMG_1026.jpg", "IMG_1034.jpg", "IMG_1041.jpg", "IMG_1044.jpg", "IMG_1048.jpg", "IMG_1081.jpg", "IMG_1085.jpg", "IMG_1104.jpg", "IMG_1107.jpg", "IMG_1130.jpg", "IMG_1152.jpg", "IMG_1159.jpg", "IMG_1190.jpg", "IMG_1192.jpg", "IMG_1201.jpg", "IMG_1224.jpg", "IMG_1241.jpg", "IMG_1249.jpg", "IMG_1274.jpg", "IMG_1280.jpg", "IMG_1284.jpg", "IMG_1288.jpg", "IMG_1297.jpg", "IMG_1334.jpg", "IMG_1356.jpg", "IMG_1371.jpg", "IMG_1460.jpg", "IMG_1468.jpg", "IMG_20191018_142522.jpg", "IMG_20191018_230609.jpg", "_13_0193.jpg", "_14_0194.jpg", "__5_0190.jpg"]
            },
            {
                folder: "2019-09-27-Arquibuuur-Complejo-Educativo-de-Cheste-27-de-septiembre-de-2019",
                title: "Complejo Educativo de Cheste 27 de septiembre de 2019",
                files: ["IMG_20190927_163706_573.jpg", "IMG_20190927_164411_617.jpg", "IMG_20190927_165445_907.jpg", "IMG_20190927_165733_931.jpg", "IMG_20190927_165849_704.jpg", "IMG_20190927_171401_396.jpg", "IMG_20190927_171901_849.jpg", "IMG_20190927_175922_739.jpg", "IMG_20190927_180051_260.jpg"]
            },
            {
                folder: "2019-09-09-Viajes-Arquibuuur-Belenpuuur-Rotterdam-Delft-y-La-Haya-9-a-13-de-septiembre-de-2019",
                title: "Rotterdam Delft y La Haya 9 a 13 de septiembre de 2019",
                files: ["IMG_0312.jpg", "IMG_0325.jpg", "IMG_0339.jpg", "IMG_0353.jpg", "IMG_0361.jpg", "IMG_0369.jpg", "IMG_0373.jpg", "IMG_0489.jpg", "IMG_0492.jpg", "IMG_0499.jpg", "IMG_0506.jpg", "IMG_0509.jpg", "IMG_0530.jpg", "IMG_0531.jpg", "IMG_0533.jpg", "IMG_0538.jpg", "IMG_0547.jpg", "IMG_0555.jpg", "IMG_0566.jpg", "IMG_0572.jpg", "IMG_0581.jpg", "IMG_0591.jpg", "IMG_0604.jpg", "IMG_0635.jpg", "IMG_0657.jpg", "IMG_0667.jpg", "IMG_0670.jpg", "IMG_0672.jpg", "IMG_0676.jpg", "IMG_0681.jpg", "IMG_0687.jpg", "IMG_0696.jpg", "IMG_0713.jpg", "IMG_0723.jpg", "IMG_0729.jpg", "IMG_0736.jpg", "IMG_0737.jpg", "IMG_0738.jpg", "IMG_0744.jpg", "IMG_0763.jpg", "IMG_0771.jpg", "IMG_0778.jpg", "IMG_0785.jpg", "IMG_0790.jpg", "IMG_0799.jpg", "IMG_0814.jpg", "IMG_0878.jpg"]
            },
            {
                folder: "2019-06-30-Viajes-Arquibuuur-Belenpuuur-Roma-30-de-junio-a-5-de-julio-de-2019",
                title: "Roma 30 de junio a 5 de julio de 2019",
                files: ["IMG_0007.jpg", "IMG_0009.jpg", "IMG_0014.jpg", "IMG_0024.jpg", "IMG_0029.jpg", "IMG_0040.jpg", "IMG_0066.jpg", "IMG_0080.jpg", "IMG_0091.jpg", "IMG_0108.jpg", "IMG_0111.jpg", "IMG_0116.jpg", "IMG_0121.jpg", "IMG_0124.jpg", "IMG_0132.jpg", "IMG_0171.jpg", "IMG_0198.jpg", "IMG_0199.jpg", "IMG_0215.jpg", "IMG_0223.jpg", "IMG_0262.jpg", "IMG_0267.jpg", "IMG_0273.jpg", "IMG_0274.jpg", "IMG_0285.jpg", "IMG_0296.jpg", "IMG_0305.jpg", "IMG_0324.jpg", "IMG_0340.jpg", "IMG_0381.jpg", "IMG_9221.jpg", "IMG_9249.jpg", "IMG_9253.jpg", "IMG_9260.jpg", "IMG_9262.jpg", "IMG_9275.jpg", "IMG_9284.jpg", "IMG_9287.jpg", "IMG_9310.jpg", "IMG_9345.jpg", "IMG_9348.jpg", "IMG_9372.jpg", "IMG_9374.jpg", "IMG_9401.jpg", "IMG_9404.jpg", "IMG_9406.jpg", "IMG_9431.jpg", "IMG_9433.jpg", "IMG_9442.jpg", "IMG_9527.jpg", "IMG_9528.jpg", "IMG_9536.jpg", "IMG_9576.jpg", "IMG_9596.jpg", "IMG_9599.jpg", "IMG_9600.jpg", "IMG_9605.jpg", "IMG_9612.jpg", "IMG_9614.jpg", "IMG_9622.jpg", "IMG_9627.jpg", "IMG_9638.jpg", "IMG_9682.jpg", "IMG_9684.jpg", "IMG_9690.jpg", "IMG_9693.jpg", "IMG_9721.jpg", "IMG_9722.jpg", "IMG_9750.jpg", "IMG_9756.jpg", "IMG_9763.jpg", "IMG_9785.jpg", "IMG_9791.jpg"]
            },
            {
                folder: "2019-03-11-Arquibuuur-Facultad-de-Filosofía-de-Valencia-11-de-marzo-de-2019",
                title: "Facultad de Filosofía de Valencia 11 de marzo de 2019",
                files: ["IMG_8919.jpg", "IMG_8924.jpg", "IMG_8927.jpg", "IMG_8928.jpg", "IMG_8938.jpg", "IMG_8945.jpg", "IMG_8949.jpg", "IMG_8957.jpg", "IMG_8958.jpg", "IMG_8962.jpg", "IMG_8967.jpg", "IMG_8975.jpg", "IMG_8977.jpg", "IMG_8985.jpg"]
            },
            {
                folder: "2019-01-31-Arquibuuur-Cevisama-Valencia-31-de-enero-de-2019",
                title: "Cevisama Valencia 31 de enero de 2019",
                files: ["IMG_8677.jpg", "IMG_8679.jpg", "IMG_8693.jpg", "IMG_8700.jpg", "IMG_8709.jpg"]
            },
            {
                folder: "2018-10-12-Viajes-Arquibuuur-Belenpuuur-Calpe-12-de-octubre-de-2018",
                title: "Calpe 12 de octubre de 2018",
                files: ["IMG_7560.jpg", "IMG_7576.jpg", "IMG_7601.jpg", "IMG_7651.jpg", "IMG_7662.jpg", "IMG_7670.jpg", "IMG_7681.jpg"]
            },
            {
                folder: "2017.11.01-Arquibuuur-IX-Certamen-Fotográfico-Renfe-1-de-noviembre-de-2017-copy",
                title: "IX Certamen Fotográfico Renfe 1 de noviembre de 2017",
                files: ["IMG_0019.jpg", "IMG_0027.jpg", "IMG_0035.jpg", "IMG_0040.jpg", "IMG_0045.jpg", "IMG_9995.jpg", "IMG_9998.jpg"]
            },
            {
                folder: "2017.09.26-Arquibuuur-Museo-Sorolla-26-de-septiembre-de-2017-copy",
                title: "Museo Sorolla 26 de septiembre de 2017",
                files: ["DSC07277.jpg", "DSC07278.jpg", "DSC07280.jpg", "DSC07290.jpg", "DSC07304.jpg"]
            },
            {
                folder: "2017.08.21-Viajes-Arquibuuur-Belenpuuur-Cantabria-21-a-26-de-agosto-de-2017-copy",
                title: "Cantabria 21 a 26 de agosto de 2017",
                files: ["IMG_7783.jpg", "IMG_7826.jpg", "IMG_7840.jpg", "IMG_7878.jpg", "IMG_7958.jpg", "IMG_7967.jpg", "IMG_7981.jpg", "IMG_8016.jpg", "IMG_8036.jpg", "IMG_8081.jpg", "IMG_8099.jpg", "IMG_8108.jpg", "IMG_8137.jpg", "IMG_8163.jpg", "IMG_8168.jpg", "IMG_8189.jpg", "IMG_8194.jpg", "IMG_8254.jpg", "IMG_8306.jpg", "IMG_8359.jpg", "IMG_8370.jpg", "IMG_8398.jpg", "IMG_8422.jpg"]
            },
            {
                folder: "2017.04.06-Arquibuuur-Viajes-Lisboa-6-a-11-de-abril-de-2017",
                title: "Lisboa 6 a 11 de abril de 2017",
                files: ["IMG_1919-2.jpg", "IMG_1922-2.jpg", "IMG_1957-2.jpg", "IMG_2054-2.jpg", "IMG_2061-2.jpg", "IMG_2070-2.jpg", "IMG_2243-2.jpg", "IMG_2511-2.jpg", "IMG_2799.JPG"]
            },
            {
                folder: "2017.02.25-Belenbruuum-Classic-Auto-25-de-febrero-de-2017",
                title: "Classic Auto 25 de febrero de 2017",
                files: ["IMG_0630.JPG", "IMG_0647.JPG", "IMG_0650.JPG", "IMG_0656.JPG"]
            },
            {
                folder: "2016.10.12-Viajes-Arquibuuur-Zaragoza-12-de-octubre-de-2016",
                title: "Zaragoza 12 de octubre de 2016",
                files: ["IMG_6774.JPG", "IMG_6801.JPG", "IMG_6825.JPG", "IMG_6832.JPG", "IMG_6911.JPG", "IMG_6939.JPG"]
            }
        ];

        // Filtra álbumes vacíos
        const albums = rawAlbums.filter((album) => Array.isArray(album.files) && album.files.length > 0);

        // Referencias al DOM
        const albumListEl = document.getElementById("album-list");
        const photoGridEl = document.getElementById("photo-grid");
        const albumTitleEl = document.getElementById("album-title");
        const albumMetaEl = document.getElementById("album-meta");

        const lightbox = document.getElementById("lightbox");
        const lightboxImage = document.getElementById("lightbox-image");
        const lightboxCaption = document.getElementById("lightbox-caption");
        const lightboxClose = document.querySelector(".lightbox-close");
        const lightboxPrev = document.querySelector(".lightbox-prev");
        const lightboxNext = document.querySelector(".lightbox-next");

        // Estado de navegación
        let activeAlbumIndex = 0;
        let activePhotoIndex = 0;

        // Utilidad: construir la ruta de una imagen
        const buildImageSrc = (folder, file) => {
            const encodedFolder = encodeURIComponent(folder);
            const encodedFile = encodeURIComponent(file);
            return `media/img/${encodedFolder}/${encodedFile}`;
        };

        // Renderiza la lista de álbumes
        const renderAlbumList = () => {
            albumListEl.innerHTML = "";

            albums.forEach((album, index) => {
                const coverSrc = buildImageSrc(album.folder, album.files[0]);
                const card = document.createElement("button");
                card.type = "button";
                card.className = "album-card" + (index === activeAlbumIndex ? " is-active" : "");
                card.style.setProperty("--album-cover", `url("${coverSrc}")`);
                card.dataset.index = index.toString();
                
                // Separa título y fecha para una lectura más clara
                const titleParts = album.title.match(/^(.+?)\s+(\d{1,2}\s+(?:de\s+)?\w+\s+(?:a|y)?\s*\d*\s*(?:de\s+)?\w*\s*(?:de\s+)?\d{4})$/)
                    || [null, album.title, ''];
                const mainTitle = titleParts[1];
                const dateStr = titleParts[2];
                
                card.innerHTML = `
                    <span class="album-card-overlay"></span>
                    <span class="album-card-content">
                        <span class="album-card-title">${mainTitle}</span>
                        ${dateStr ? `<span class="album-card-date">${dateStr}</span>` : ''}
                        <span class="album-card-count">${album.files.length} fotos</span>
                    </span>
                `;
                card.addEventListener("click", () => {
                    activeAlbumIndex = index;
                    renderAlbumList();
                    renderAlbumPhotos();
                    // Scroll automático al album-view
                    document.getElementById("album-view").scrollIntoView({ behavior: "smooth", block: "start" });
                });
                albumListEl.appendChild(card);
            });
        };

        // Renderiza las fotos del álbum activo
        const renderAlbumPhotos = () => {
            const album = albums[activeAlbumIndex];
            if (!album) {
                albumTitleEl.textContent = "Elige un album";
                albumMetaEl.textContent = "Selecciona un album para cargar las fotos.";
                photoGridEl.innerHTML = "";
                return;
            }

            albumTitleEl.textContent = album.title;
            albumMetaEl.textContent = `${album.files.length} fotos`;
            photoGridEl.innerHTML = "";

            album.files.forEach((file, index) => {
                const src = buildImageSrc(album.folder, file);
                const button = document.createElement("button");
                button.type = "button";
                button.className = "photo-item";
                button.innerHTML = `<img src="${src}" alt="${album.title} ${index + 1}" loading="lazy">`;
                button.addEventListener("click", () => {
                    openLightbox(album, index);
                });
                photoGridEl.appendChild(button);
            });
        };

        // Abre el lightbox en la foto seleccionada
        const openLightbox = (album, index) => {
            activePhotoIndex = index;
            updateLightbox(album);
            lightbox.classList.add("is-open");
            lightbox.setAttribute("aria-hidden", "false");
            document.body.classList.add("lightbox-open");
        };

        // Cierra el lightbox y restablece el scroll
        const closeLightbox = () => {
            lightbox.classList.remove("is-open");
            lightbox.setAttribute("aria-hidden", "true");
            document.body.classList.remove("lightbox-open");
        };

        // Actualiza imagen y pie de foto del lightbox
        const updateLightbox = (album) => {
            const file = album.files[activePhotoIndex];
            const src = buildImageSrc(album.folder, file);
            lightboxImage.src = src;
            lightboxImage.alt = `${album.title} ${activePhotoIndex + 1}`;
            lightboxCaption.textContent = `${album.title} (${activePhotoIndex + 1}/${album.files.length})`;
        };

        // Avanza o retrocede dentro del álbum
        const stepPhoto = (direction) => {
            const album = albums[activeAlbumIndex];
            if (!album) return;
            activePhotoIndex = (activePhotoIndex + direction + album.files.length) % album.files.length;
            updateLightbox(album);
        };

        // Eventos del lightbox
        lightboxClose.addEventListener("click", closeLightbox);
        lightboxPrev.addEventListener("click", () => stepPhoto(-1));
        lightboxNext.addEventListener("click", () => stepPhoto(1));
        lightbox.addEventListener("click", (event) => {
            if (event.target === lightbox) {
                closeLightbox();
            }
        });
        document.addEventListener("keydown", (event) => {
            if (!lightbox.classList.contains("is-open")) return;
            if (event.key === "Escape") closeLightbox();
            if (event.key === "ArrowLeft") stepPhoto(-1);
            if (event.key === "ArrowRight") stepPhoto(1);
        });

        renderAlbumList();
        renderAlbumPhotos();
    </script>
</body>
</html>
